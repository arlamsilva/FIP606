{"title":"Aula10","markdown":{"yaml":{"title":"Aula10","author":"ARLAM"},"headingText":"Três ou mais tratamentos","containsRefs":false,"markdown":"\n\n\n## Anova 1 fator\n\nExperimento com um fator e em delineamento inteiramente casualizado para comparar o crescimento micelial de diferentes espécies de um fungo fitopatogênico. A resposta a ser estudada é a TCM = taxa de crescimento micelial.\n\n### Preparo \n\n```{r}\nlibrary(readxl)\nlibrary(tidyverse)\nmicelial <- read_excel(\"dados-diversos.xlsx\", \"micelial\")\nhead(micelial)\n```\n\n```{r}\nmicelial %>%\n  ggplot(aes(especie, tcm)) +\n  geom_boxplot()\n```\n\n### Premissas \n\n### Modelo usando `aov()`\n\n```{r}\naov1 <- aov(tcm ~ especie, \n            data = micelial)\nsummary(aov1)\n\nlibrary(performance)\ncheck_heteroscedasticity(aov1)\ncheck_normality(aov1)\nlibrary(DHARMa)\nplot(simulateResiduals(aov1))\n\n# teste de normalidade\nhist(aov1$residuals)\nqqnorm(aov1$residuals)\nqqline(aov1$residuals)\nshapiro.test(aov1$residuals)\n\n\n```\n\n\n\n\n#### Interpretação\n\nPremissas da anova atendidas. Efeito não significativo de espécies. \n\n\n## E quanto não atende às premissas?\n\nEfeito de inseticida na mortalidade de insetos (Beall, 1942). The Transformation of data from entomological field experiments, Biometrika, 29, 243–262. Dados no pacote \"datasets\" do R. data(InsectSprays)\n\n```{r}\ninsects <- tbl_df(InsectSprays) |> \n  select(spray, count)\n```\n\n```{r}\ninsects %>%\n  ggplot(aes(spray, count))+\n  geom_boxplot() \n```\n\n#### Anova paramétrica\n\n\n```{r}\naov2 <- aov(count ~ spray, data = insects)\nsummary(aov2)\ncheck_normality(aov2)\ncheck_heteroscedasticity(aov2)\nplot(simulateResiduals(aov2))\nlibrary(emmeans)\naov2_means <- emmeans(aov2, ~ spray,\n                      type = \"response\")\naov2_means\npwpm(aov2_means)\nlibrary(multcomp)\nlibrary(multcompView)\ncld(aov2_means)\n\n\n\n```\n\n\nQualidade ajuste do modelo\n\n```{r}\n\n# não paramétrico\nkruskal.test(count ~ spray, data = insects)\nlibrary(agricolae)\nkruskal(insects$count, insects$spray, \n        console = TRUE)\n\n\n```\n\n# Modelo linear generalizado\n\n```{r}\nglm1 <- glm(count ~ spray,\n  data = insects,\n  family = poisson(link = \"identity\"))\nplot(simulateResiduals(glm1))\nsummary(glm1)\nglm1_means <- emmeans(glm1, ~ spray)\ncld(glm1_means)\n```\n\n\n\n####  Anova não paramétrica\n\n```{r}\n\ninsects\nkruskal.test(count ~ spray, data = insects)\nlibrary(agricolae)\nattach(insects)\nkruskal(insects$count, insects$spray, console = TRUE)\n```\n\n\n#### GLM família poisson\n\n```{r}\n# distribuição da resposta\nattach(insects)\ninsects\nhist(count)\n```\n\n\n```{r}\n# modelo linear generalizado\nm2 <- lm(count ~ spray, data = insects)\nsummary(m2)\n\nanova(m2)\n\nm4 <- glm(count ~ spray,\n  data = insects,\n  family = poisson(link = \"identity\")\n)\n\nsummary(m4)\nanova(m4)\nhist(residuals(m2))\nhist(residuals(m4))\n```\n\n```{r}\n# resultados extraidos da lista\nlibrary(broom)\ntidy(m4)\n```\n\n\n```{r, message=FALSE, warning=FALSE}\n# ajuste do modelo\nlibrary(boot)\nm4.diag <- glm.diag(m4)\nglm.diag.plots(m4, glm.diag(m4))\n```\n\nComparação de médias\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(emmeans)\nem <- emmeans(m4, ~spray)\npwpp(em)\nmultcomp::cld(em) \n```\n\n```{r}\n\nlibrary(lsmeans)\nlibrary(multcomp)\n\nmedias2 <- lsmeans(m4, ~spray, Letters = LETTERS)\ncld(medias2, by = NULL, Letters = LETTERS, alpha = .05)\nplot(cld(medias2, by = NULL, Letters = LETTERS, alpha = .05))\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"aula10.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"cosmo","title":"Aula10","author":"ARLAM"},"extensions":{"book":{"multiFile":true}}}}}