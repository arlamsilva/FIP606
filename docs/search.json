[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "aula1.html",
    "href": "aula1.html",
    "title": "Aula1",
    "section": "",
    "text": "Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see https://quarto.org."
  },
  {
    "objectID": "aula1.html#running-code",
    "href": "aula1.html#running-code",
    "title": "Aula1",
    "section": "Running Code",
    "text": "Running Code\nWhen you click the Render button a document will be generated that includes both content and the output of embedded code. You can embed code like this:\n\n1 + 1\n\n[1] 2\n\n\nYou can add options to executable code like this\n\n\n[1] 4\n\n\nThe echo: false option disables the printing of code (only output is displayed)."
  },
  {
    "objectID": "aula10.html",
    "href": "aula10.html",
    "title": "Aula10",
    "section": "",
    "text": "Experimento com um fator e em delineamento inteiramente casualizado para comparar o crescimento micelial de diferentes espécies de um fungo fitopatogênico. A resposta a ser estudada é a TCM = taxa de crescimento micelial.\n\n\n\nlibrary(readxl)\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nmicelial <- read_excel(\"dados-diversos.xlsx\", \"micelial\")\nhead(micelial)\n\n# A tibble: 6 × 3\n  especie   rep   tcm\n  <chr>   <dbl> <dbl>\n1 Fasi        1  1.5 \n2 Fasi        2  1.59\n3 Fasi        3  1.52\n4 Fasi        4  1.52\n5 Fasi        5  1.24\n6 Fasi        6  1.29\n\n\n\nmicelial %>%\n  ggplot(aes(especie, tcm)) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n\n\n\naov1 <- aov(tcm ~ especie, \n            data = micelial)\nsummary(aov1)\n\n            Df Sum Sq Mean Sq F value Pr(>F)\nespecie      4 0.4692 0.11729   1.983  0.117\nResiduals   37 2.1885 0.05915               \n\nlibrary(performance)\n\nWarning: package 'performance' was built under R version 4.2.3\n\ncheck_heteroscedasticity(aov1)\n\nOK: Error variance appears to be homoscedastic (p = 0.175).\n\ncheck_normality(aov1)\n\nOK: residuals appear as normally distributed (p = 0.074).\n\nlibrary(DHARMa)\n\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n\nplot(simulateResiduals(aov1))\n\nWarning in checkModel(fittedModel): DHARMa: fittedModel not in class of\nsupported models. Absolutely no guarantee that this will work!\n\n\n\n\n# teste de normalidade\nhist(aov1$residuals)\n\n\n\nqqnorm(aov1$residuals)\nqqline(aov1$residuals)\n\n\n\nshapiro.test(aov1$residuals)\n\n\n    Shapiro-Wilk normality test\n\ndata:  aov1$residuals\nW = 0.95101, p-value = 0.07022\n\n\n\n\nPremissas da anova atendidas. Efeito não significativo de espécies.\n\n\n\n\n\nEfeito de inseticida na mortalidade de insetos (Beall, 1942). The Transformation of data from entomological field experiments, Biometrika, 29, 243–262. Dados no pacote “datasets” do R. data(InsectSprays)\n\ninsects <- tbl_df(InsectSprays) |> \n  select(spray, count)\n\nWarning: `tbl_df()` was deprecated in dplyr 1.0.0.\nℹ Please use `tibble::as_tibble()` instead.\n\n\n\ninsects %>%\n  ggplot(aes(spray, count))+\n  geom_boxplot() \n\n\n\n\n\n\n\naov2 <- aov(count ~ spray, data = insects)\nsummary(aov2)\n\n            Df Sum Sq Mean Sq F value Pr(>F)    \nspray        5   2669   533.8    34.7 <2e-16 ***\nResiduals   66   1015    15.4                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\ncheck_normality(aov2)\n\nWarning: Non-normality of residuals detected (p = 0.022).\n\ncheck_heteroscedasticity(aov2)\n\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n\nplot(simulateResiduals(aov2))\n\nWarning in checkModel(fittedModel): DHARMa: fittedModel not in class of\nsupported models. Absolutely no guarantee that this will work!\n\n\n\n\nlibrary(emmeans)\n\nWarning: package 'emmeans' was built under R version 4.2.3\n\naov2_means <- emmeans(aov2, ~ spray,\n                      type = \"response\")\naov2_means\n\n spray emmean   SE df lower.CL upper.CL\n A      14.50 1.13 66   12.240    16.76\n B      15.33 1.13 66   13.073    17.59\n C       2.08 1.13 66   -0.177     4.34\n D       4.92 1.13 66    2.656     7.18\n E       3.50 1.13 66    1.240     5.76\n F      16.67 1.13 66   14.406    18.93\n\nConfidence level used: 0.95 \n\npwpm(aov2_means)\n\n        A       B       C       D       E       F\nA [14.50]  0.9952  <.0001  <.0001  <.0001  0.7542\nB  -0.833 [15.33]  <.0001  <.0001  <.0001  0.9603\nC  12.417  13.250 [ 2.08]  0.4921  0.9489  <.0001\nD   9.583  10.417  -2.833 [ 4.92]  0.9489  <.0001\nE  11.000  11.833  -1.417   1.417 [ 3.50]  <.0001\nF  -2.167  -1.333 -14.583 -11.750 -13.167 [16.67]\n\nRow and column labels: spray\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean)   type = \"response\"\nLower triangle: Comparisons (estimate)   earlier vs. later\n\nlibrary(multcomp)\n\nCarregando pacotes exigidos: mvtnorm\n\n\nCarregando pacotes exigidos: survival\n\n\nWarning: package 'survival' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: TH.data\n\n\nWarning: package 'TH.data' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: MASS\n\n\nWarning: package 'MASS' was built under R version 4.2.3\n\n\n\nAttaching package: 'MASS'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\n\n\nAttaching package: 'TH.data'\n\n\nThe following object is masked from 'package:MASS':\n\n    geyser\n\nlibrary(multcompView)\n\nWarning: package 'multcompView' was built under R version 4.2.3\n\ncld(aov2_means)\n\n spray emmean   SE df lower.CL upper.CL .group\n C       2.08 1.13 66   -0.177     4.34  1    \n E       3.50 1.13 66    1.240     5.76  1    \n D       4.92 1.13 66    2.656     7.18  1    \n A      14.50 1.13 66   12.240    16.76   2   \n B      15.33 1.13 66   13.073    17.59   2   \n F      16.67 1.13 66   14.406    18.93   2   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\n\nQualidade ajuste do modelo\n\n# não paramétrico\nkruskal.test(count ~ spray, data = insects)\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  count by spray\nKruskal-Wallis chi-squared = 54.691, df = 5, p-value = 1.511e-10\n\nlibrary(agricolae)\nkruskal(insects$count, insects$spray, \n        console = TRUE)\n\n\nStudy: insects$count ~ insects$spray\nKruskal-Wallis test's\nTies or no Ties\n\nCritical Value: 54.69134\nDegrees of freedom: 5\nPvalue Chisq  : 1.510845e-10 \n\ninsects$spray,  means of the ranks\n\n  insects.count  r\nA      52.16667 12\nB      54.83333 12\nC      11.45833 12\nD      25.58333 12\nE      19.33333 12\nF      55.62500 12\n\nPost Hoc Analysis\n\nt-Student: 1.996564\nAlpha    : 0.05\nMinimum Significant Difference: 8.462804 \n\nTreatments with the same letter are not significantly different.\n\n  insects$count groups\nF      55.62500      a\nB      54.83333      a\nA      52.16667      a\nD      25.58333      b\nE      19.33333     bc\nC      11.45833      c"
  },
  {
    "objectID": "aula11.html",
    "href": "aula11.html",
    "title": "AULA 11",
    "section": "",
    "text": "library(tidyverse)\nlibrary(readxl)\nfungicida_vaso<-read_excel(\"C:dados-diversos.xlsx\", \"fungicida_vaso\")\n\nm1<- fungicida_vaso |> \n  mutate(inc=dis_sp/n_sp*100)\n\n\nm1 |> \nggplot(aes(x=treat, y=inc))+\n  geom_jitter(width = 0.1)+facet_wrap(~dose)\n\n\n\n\n\nm1<-aov(log(inc+0.5)~treat*dose, \n        data=m1)\nsummary(m1)\n\n            Df Sum Sq Mean Sq F value  Pr(>F)   \ntreat        1 12.928  12.928  13.980 0.00179 **\ndose         1  5.663   5.663   6.124 0.02491 * \ntreat:dose   1  5.668   5.668   6.129 0.02486 * \nResiduals   16 14.796   0.925                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nlibrary(performance)\n\nWarning: package 'performance' was built under R version 4.2.3\n\ncheck_normality(m1)\n\nWarning: Non-normality of residuals detected (p = 0.050).\n\ncheck_heteroscedasticity(m1)\n\nOK: Error variance appears to be homoscedastic (p = 0.180).\n\nlibrary(DHARMa)\n\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n\nplot(simulateResiduals(m1))\n\nWarning in checkModel(fittedModel): DHARMa: fittedModel not in class of\nsupported models. Absolutely no guarantee that this will work!\n\n\n\n\n\n\nmilho3<-read_excel(\"C:dados-diversos.xlsx\", \"milho\")\nm4<-aov(yield~hybrid,\n        data = milho3)\nsummary(m4)\n\n            Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid       5 105876446 21175289   8.688 1.02e-05 ***\nResiduals   42 102371996  2437428                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nlibrary(agridat)\ndata(cochran.beets)\ndat = cochran.beets\n\n# P has strong effect\nlibs(lattice)\n\nWarning: package 'lattice' was built under R version 4.2.3\n\nxyplot(yield ~ plants|fert, dat, main=\"cochran.beets\")"
  },
  {
    "objectID": "aula12.html",
    "href": "aula12.html",
    "title": "aula12",
    "section": "",
    "text": "library(readxl)\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nfungicidas <- read_excel(\"C:dados-diversos.xlsx\", \"fungicida_campo\")"
  },
  {
    "objectID": "aula12.html#modelo-anova-com-bloco",
    "href": "aula12.html#modelo-anova-com-bloco",
    "title": "aula12",
    "section": "Modelo anova com bloco",
    "text": "Modelo anova com bloco\n\naov_fung <- aov(sev ~ trat + rep, data = fungicidas)\nsummary(aov_fung)  \n\n            Df Sum Sq Mean Sq F value Pr(>F)    \ntrat         7   7135  1019.3 287.661 <2e-16 ***\nrep          1     19    18.6   5.239 0.0316 *  \nResiduals   23     81     3.5                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nlibrary(performance)\n\nWarning: package 'performance' was built under R version 4.2.3\n\ncheck_normality(aov_fung)\n\nOK: residuals appear as normally distributed (p = 0.230).\n\ncheck_heteroscedasticity(aov_fung)\n\nOK: Error variance appears to be homoscedastic (p = 0.484).\n\nlibrary(emmeans)\n\nWarning: package 'emmeans' was built under R version 4.2.3\n\nmeans_fung <- emmeans(aov_fung, ~ trat)\nlibrary(multcomp)\n\nCarregando pacotes exigidos: mvtnorm\n\n\nCarregando pacotes exigidos: survival\n\n\nWarning: package 'survival' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: TH.data\n\n\nWarning: package 'TH.data' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: MASS\n\n\nWarning: package 'MASS' was built under R version 4.2.3\n\n\n\nAttaching package: 'MASS'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\n\n\nAttaching package: 'TH.data'\n\n\nThe following object is masked from 'package:MASS':\n\n    geyser\n\nlibrary(multcompView)\n\nWarning: package 'multcompView' was built under R version 4.2.3\n\ncld(means_fung)\n\n trat       emmean    SE df lower.CL upper.CL .group\n G            29.2 0.941 23     27.3     31.2  1    \n B            29.5 0.941 23     27.6     31.4  1    \n E            30.1 0.941 23     28.2     32.1  1    \n C            30.4 0.941 23     28.4     32.3  1    \n A            30.4 0.941 23     28.4     32.3  1    \n D            31.5 0.941 23     29.6     33.4  12   \n F            35.5 0.941 23     33.6     37.4   2   \n testemunha   75.8 0.941 23     73.8     77.7    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n\nplot(means_fung)+\n  coord_flip()+\n  theme_minimal()"
  },
  {
    "objectID": "aula12.html#parcela-subdividida-split-plot",
    "href": "aula12.html#parcela-subdividida-split-plot",
    "title": "aula12",
    "section": "Parcela subdividida (split-plot)",
    "text": "Parcela subdividida (split-plot)\n\nmilho <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\n# Base R\n# DBC\n# model <- aov(Response ~ Block*WholePlotFactor*SubPlotFactor + Error(Block/WholePlotFactor/SubPlotFactor), data = mydata)\n\naov_milho_bloco <- aov(index ~ factor(block) + hybrid*method + Error(factor(block)/hybrid/method), data = milho)\n\nsummary(aov_milho_bloco)\n\n\nError: factor(block)\n              Df Sum Sq Mean Sq\nfactor(block)  3  592.2   197.4\n\nError: factor(block):hybrid\n          Df Sum Sq Mean Sq F value Pr(>F)  \nhybrid     5  974.2  194.84    3.14 0.0389 *\nResiduals 15  930.9   62.06                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: factor(block):hybrid:method\n              Df Sum Sq Mean Sq F value Pr(>F)  \nmethod         1  79.61   79.61   4.726 0.0433 *\nhybrid:method  5 265.28   53.06   3.150 0.0324 *\nResiduals     18 303.18   16.84                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n# Using lme4 library\n# Load lme4 library\nlibrary(lme4)\n\nWarning: package 'lme4' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: Matrix\n\n\nWarning: package 'Matrix' was built under R version 4.2.3\n\n\n\nAttaching package: 'Matrix'\n\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\n# using blocks\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(sqrt(index) ~ block + hybrid*method + (1|block/hybrid), data = milho)\nlibrary(car)\n\nWarning: package 'car' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: carData\n\n\n\nAttaching package: 'car'\n\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nAnova(mix2)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nblock          0.0764  3   0.994506   \nhybrid        15.4171  5   0.008721 **\nmethod         3.9239  1   0.047605 * \nhybrid:method 13.3025  5   0.020703 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\ncheck_normality(mix2)\n\nOK: residuals appear as normally distributed (p = 0.422).\n\ncheck_heteroscedasticity(mix2)\n\nOK: Error variance appears to be homoscedastic (p = 0.970).\n\nmeans_mix2 <- emmeans(mix2, ~ hybrid | method)\nmeans_mix2\n\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   5.00 1.17 5356     2.69     7.30\n 30F53 YH   4.95 1.17 5356     2.65     7.25\n 30K64      4.50 1.17 5356     2.20     6.81\n 30S31H     6.10 1.17 5356     3.79     8.40\n 30S31YH    5.63 1.17 5356     3.33     7.93\n BG7049H    4.40 1.17 5356     2.10     6.71\n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   4.94 1.17 5356     2.64     7.25\n 30F53 YH   5.10 1.17 5356     2.80     7.41\n 30K64      4.61 1.17 5356     2.31     6.91\n 30S31H     5.13 1.17 5356     2.83     7.43\n 30S31YH    5.14 1.17 5356     2.84     7.44\n BG7049H    4.37 1.17 5356     2.07     6.67\n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \n\ncld(means_mix2)\n\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.40 1.17 5356     2.10     6.71  1    \n 30K64      4.50 1.17 5356     2.20     6.81  1    \n 30F53 YH   4.95 1.17 5356     2.65     7.25  12   \n 30F53 HX   5.00 1.17 5356     2.69     7.30  12   \n 30S31YH    5.63 1.17 5356     3.33     7.93  12   \n 30S31H     6.10 1.17 5356     3.79     8.40   2   \n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.37 1.17 5356     2.07     6.67  1    \n 30K64      4.61 1.17 5356     2.31     6.91  1    \n 30F53 HX   4.94 1.17 5356     2.64     7.25  1    \n 30F53 YH   5.10 1.17 5356     2.80     7.41  1    \n 30S31H     5.13 1.17 5356     2.83     7.43  1    \n 30S31YH    5.14 1.17 5356     2.84     7.44  1    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same."
  },
  {
    "objectID": "aula13.html",
    "href": "aula13.html",
    "title": "aula13",
    "section": "",
    "text": "carrega pacotes\n\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(readxl)\n\nestande <- read_excel(\"C:dados-diversos.xlsx\", \"estande\")\n\nestande |> \n  ggplot(aes(trat, nplants, group = exp))+\n  geom_point()+\n  #facet_wrap(~exp)+\n  ylim(0,max(estande$nplants))+\n  geom_smooth(se = F, method = \"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n#Modelos mistos\n\nexp1 <- estande |> \n  filter(exp == 1) \nm1 <- lm(nplants ~ trat, data = exp1)\nsummary(m1)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp1)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.500  -6.532   1.758   8.573  27.226 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  52.5000     4.2044  12.487 1.84e-11 ***\ntrat         -0.2419     0.1859  -1.301    0.207    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15 on 22 degrees of freedom\nMultiple R-squared:  0.07148,   Adjusted R-squared:  0.02928 \nF-statistic: 1.694 on 1 and 22 DF,  p-value: 0.2066\n\nexp2 <- estande |> \n  filter(exp == 2) \nm2 <- lm(nplants ~ trat, data = exp2)\nsummary(m2)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,    Adjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n\nexp3 <- estande |> \n  filter(exp == 3) \nm3 <- lm(nplants ~ trat, data = exp3)\nsummary(m3)\n\n\nCall:\nlm(formula = nplants ~ trat, data = exp3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-26.5887  -3.9597   0.7177   5.5806  19.8952 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  95.7500     2.9529  32.425  < 2e-16 ***\ntrat         -0.7634     0.1306  -5.847 6.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 10.53 on 22 degrees of freedom\nMultiple R-squared:  0.6085,    Adjusted R-squared:  0.5907 \nF-statistic: 34.19 on 1 and 22 DF,  p-value: 6.968e-06\n\ng1 <- exp1 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  geom_abline(intercept = 52.5, \n              slope = -0.24) +\n    ylim(0, max(estande$nplants))+\n # geom_smooth(method = \"lm\", se = F)+\n  theme_bw()+\n  annotate(geom = \"text\", x = 24,\n           y = 70, label = \"y = 52.5 - 0.24x\")\n\ng2 <- exp3 |> \n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  ylim(0, max(estande$nplants))+\n  geom_smooth(method = \"lm\", se = F)+\n  annotate(geom = \"text\", x = 24,\n           y = 70, label = \"y = 52.5 - 0.24x\")\nlibrary(patchwork)\n\nWarning: package 'patchwork' was built under R version 4.2.3\n\ng1 + g2\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nlibrary(lme4)\n\nWarning: package 'lme4' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: Matrix\n\n\nWarning: package 'Matrix' was built under R version 4.2.3\n\n\n\nAttaching package: 'Matrix'\n\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\nmix <- lmer(nplants ~ trat + (trat | exp), \n            data = estande)\n\nWarning in checkConv(attr(opt, \"derivs\"), opt$par, ctrl = control$checkConv, :\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n\nsummary(mix)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: nplants ~ trat + (trat | exp)\n   Data: estande\n\nREML criterion at convergence: 580.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.0988 -0.6091  0.1722  0.6360  1.9963 \n\nRandom effects:\n Groups   Name        Variance  Std.Dev. Corr \n exp      (Intercept) 510.68405 22.5983       \n          trat          0.05516  0.2349  -0.82\n Residual             167.91303 12.9581       \nNumber of obs: 72, groups:  exp, 3\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  69.7452    13.2146   5.278\ntrat         -0.5687     0.1643  -3.462\n\nCorrelation of Fixed Effects:\n     (Intr)\ntrat -0.731\noptimizer (nloptwrap) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.00274249 (tol = 0.002, component 1)\n\nlibrary(car)\n\nWarning: package 'car' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: carData\n\n\n\nAttaching package: 'car'\n\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nAnova(mix)\n\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: nplants\n      Chisq Df Pr(>Chisq)    \ntrat 11.985  1  0.0005362 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "aula14.html",
    "href": "aula14.html",
    "title": "aula14",
    "section": "",
    "text": "library(readxl)\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\n\nestande |> \n  ggplot(aes(trat, nplants, group = exp))+\n  geom_point()+\n  facet_wrap(~exp)+\n  ylim(0,max(estande$nplants))+\n  geom_smooth(se = F)\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\nlibrary(ggtext)\n\nWarning: package 'ggtext' was built under R version 4.2.3\n\nestande2 <- estande |>\n  filter(exp == 2)|>\n  group_by(trat) |> \n  summarise(mean_nplants = mean(nplants))\n\nestande2 |> \n  ggplot(aes(trat, mean_nplants))+\n  geom_point()+\n  #geom_line()+\n  geom_smooth(se = F, formula = y ~ poly(x, 2), method = \"lm\", color = \"black\")+\n  theme_minimal()+\n  annotate(geom = \"text\",\n           x = 25, y = 70,\n           label = \"y = 66.3 - 1.777x + 0.0222x2 \nR2 = 0.88\")\n\n\n\n\n\nestande2 <- estande2 |> \n  mutate(trat2 = trat^2)\n\nm1 <- lm(mean_nplants ~ trat, \n         data = estande2)\nsummary(m1)\n\n\nCall:\nlm(formula = mean_nplants ~ trat, data = estande2)\n\nResiduals:\n     1      2      3      4      5      6 \n12.764 -2.134 -6.782 -3.327 -4.669  4.147 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     4.5505  13.402 0.000179 ***\ntrat         -0.7007     0.2012  -3.483 0.025294 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.117 on 4 degrees of freedom\nMultiple R-squared:  0.752, Adjusted R-squared:   0.69 \nF-statistic: 12.13 on 1 and 4 DF,  p-value: 0.02529\n\nhist(m1$residuals)\n\n\n\nm2 <- lm(mean_nplants ~ trat + trat2, \n         data = estande2)\nsummary(m2)\n\n\nCall:\nlm(formula = mean_nplants ~ trat + trat2, data = estande2)\n\nResiduals:\n      1       2       3       4       5       6 \n 7.4484 -4.4200 -6.4386  1.0739  3.0474 -0.7111 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.70800  14.083 0.000776 ***\ntrat        -1.77720    0.62263  -2.854 0.064878 .  \ntrat2        0.02223    0.01242   1.790 0.171344    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.517 on 3 degrees of freedom\nMultiple R-squared:  0.8801,    Adjusted R-squared:  0.8001 \nF-statistic: 11.01 on 2 and 3 DF,  p-value: 0.04152\n\nAIC(m1, m2)\n\n   df      AIC\nm1  3 45.72200\nm2  4 43.36151\n\n\n\nDuas variáveis resposta\n\nmofo <- read_excel(\"dados-diversos.xlsx\",\n                   \"mofo\")\nmofo |> \n  ggplot(aes(inc, yld))+\n  geom_point()+\n  geom_smooth(se = F, method = \"lm\")+\n  facet_wrap(~ study)\n\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "aula15.html",
    "href": "aula15.html",
    "title": "Aula15",
    "section": "",
    "text": "##TABALEAS DE CONTIGÊNCIA\n#Vamos utilizar aqui os dados milsa de Bussab & Morettin discutidos na Sessão 8.2 e que podem ser obtidos conforme comando abaixo. Repetimos aqui o preparo inicial dos dados convertendo as variáveis categóricas em fatores do R e criando a variável idade.\n\n  milsa <- read.table(\"http://www.leg.ufpr.br/~paulojus/dados/milsa.dat\",\n       head = T)\nmilsa <- transform(milsa, civil = factor(civil, label = c(\"solteiro\",\n  \"casado\"), levels = 1:2), instrucao = factor(instrucao, label = c(\"1oGrau\",\n       \"2oGrau\", \"Superior\"), lev = 1:3, ord = T), regiao = factor(regiao,\n      label = c(\"capital\", \"interior\", \"outro\"), lev = c(2, 1,\n        3)))\n   milsa <- transform(milsa, idade = ano + mes/12)\n   names(milsa)\n\n[1] \"funcionario\" \"civil\"       \"instrucao\"   \"filhos\"      \"salario\"    \n[6] \"ano\"         \"mes\"         \"regiao\"      \"idade\"      \n\n\n#Tabelas de contingência podem ser obtidas com as frequências de ocorrência dos cruzamentos das variáveis. A seguir mostramos algumas opções da vizualização dos resultados usando a função table() e a função ftable(). As funções retornam as tabelas de contingência em um objeto que pode ser uma matrix, no caso do cruzamento de duas variáveis, ou de forma mais geral, na forma de um array, onde o número de dimensões é igual ao número de variáveis. Entretanto a classe do objeto resultante vai depender da função utilizada. Neste caso, para o cruzamento de apenas duas variáveis, os resultados são exibidos de forma semelhante. No exemplo consideram-se as variáveis civil e instrucao que situadas nas colunas 2 e 3 do data-frame.\n\n    t1 <- table(milsa[c(2, 3)])\n    \n    t1\n\n          instrucao\ncivil      1oGrau 2oGrau Superior\n  solteiro      7      6        3\n  casado        5     12        3\n\n    t1f <- ftable(milsa[c(2, 3)])\n   t1f\n\n         instrucao 1oGrau 2oGrau Superior\ncivil                                    \nsolteiro                7      6        3\ncasado                  5     12        3\n\n   sapply(list(t1, t1f), class)\n\n[1] \"table\"  \"ftable\"\n\n   sapply(list(t1, t1f), is.matrix)\n\n[1] TRUE TRUE\n\n   sapply(list(t1, t1f), is.array)\n\n[1] TRUE TRUE\n\n\n#Ambas funções possuem o argumento dnn que pode ser usado para sobrescrever os nomes das dimensões do objeto resultante.\n\ndimnames(t1)\n\n$civil\n[1] \"solteiro\" \"casado\"  \n\n$instrucao\n[1] \"1oGrau\"   \"2oGrau\"   \"Superior\"\n\nt1 <- table(milsa[c(2, 3)], dnn = c(\"Estado Civil\", \"Nível de Instrução\"))\n dimnames(t1)\n\n$`Estado Civil`\n[1] \"solteiro\" \"casado\"  \n\n$`Nível de Instrução`\n[1] \"1oGrau\"   \"2oGrau\"   \"Superior\"\n\n t1f <- table(milsa[c(2, 3)], dnn = c(\"Estado Civil\", \"Nível de Instrução\"))\n\n#As diferenças na forma de exibir os resultados são mais claras considerando-se o cruzamento de três ou mais variáveis. Enquanto table() vai exibir um array da forma usual, mostrando as várias camadas separadamente, ftable() irá arranjar a tabela de forma plana, em uma visualização mais adequada para a leitura dos dados. Vamos considerar o cruzamento das variáveis civil, instrucao e regiao situadas nas colunas 2, 3 e 8 do data-frame.\n\nt2 <- with(milsa, table(civil, instrucao, regiao))\nt2\n\n, , regiao = capital\n\n          instrucao\ncivil      1oGrau 2oGrau Superior\n  solteiro      2      1        1\n  casado        2      4        1\n\n, , regiao = interior\n\n          instrucao\ncivil      1oGrau 2oGrau Superior\n  solteiro      2      1        1\n  casado        1      6        1\n\n, , regiao = outro\n\n          instrucao\ncivil      1oGrau 2oGrau Superior\n  solteiro      3      4        1\n  casado        2      2        1\n\n t2f <- with(milsa, ftable(civil, instrucao, regiao))\n t2f\n\n                   regiao capital interior outro\ncivil    instrucao                              \nsolteiro 1oGrau                 2        2     3\n         2oGrau                 1        1     4\n         Superior               1        1     1\ncasado   1oGrau                 2        1     2\n         2oGrau                 4        6     2\n         Superior               1        1     1\n\n\n\n\nEnquanto que o objeto retornado por table() não é uma matrix, mas sim um array de três dimensões, por serem três variáveis. A dimensão do array é de 2 × 3 × 3 por haver 2 estados civis, 3 níveis de instrução e 3 regiões. Já o objeto retornado por ftable() ainda é uma matriz, neste caso de dimensão 6 × 3 onde 6 = 2 × 3 indicando o produto do número de nívies das duas primeiras variáveis.\n\nsapply(list(t2, t2f), is.matrix)\n\n[1] FALSE  TRUE\n\nsapply(list(t2, t2f), is.array)\n\n[1] TRUE TRUE\n\nsapply(list(t2, t2f), dim)\n\n[[1]]\n[1] 2 3 3\n\n[[2]]\n[1] 6 3"
  },
  {
    "objectID": "aula16.html",
    "href": "aula16.html",
    "title": "Aula16",
    "section": "",
    "text": "library(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(readxl)\nlibrary(ggplot2)\nlibrary(r4pde)\nlibrary(rnaturalearth)\n\nWarning: package 'rnaturalearth' was built under R version 4.2.3\n\nlibrary(rnaturalearthhires)\n\nInstalar pacote do github:\n\nremotes::install_github(\"ropensci/rnaturalearthhires\")\n\nSkipping install of 'rnaturalearthhires' from a github remote, the SHA1 (c3785a8c) has not changed since last install.\n  Use `force = TRUE` to force installation\n\n\nConjunto de dados: Para plotar o mapa do pais, usa-se a função ne_countries\n\nsbr <- RustSoybean\n\nBRA <- ne_countries(country = \"Brazil\", \n                    returnclass = \"sf\")\nggplot(BRA) +\ngeom_sf(fill = \"white\")\n\n\n\n\nPara plotar os estados:\n\nBRA <- ne_states(country = \"Brazil\", \n                    returnclass = \"sf\")\nggplot(BRA) +\ngeom_sf(color = \"white\",\n          fill = \"darkgreen\") +\n  theme_void()\n\n\n\n\nPara selecionar um estado: Para\n\nBRA <- ne_states(country = \"Brazil\", \n                    returnclass = \"sf\")\nMG <- BRA |> filter(name_en == \"Minas Gerais\")\nggplot(BRA) +\ngeom_sf(color = \"black\",\n          fill = \"white\") +\n  geom_sf(data = MG, color = \"black\",\n            fill = \"green\")\n\n\n\n\nPara inserir os pontos especificos dos dados (latitude e longitude): Para plotar os pontos, precisa-se das coordenadas de onde foram coletados os pontos. Ex.: pontos de coleta - precisa-se coletar as coordenadas para plotar em um mapa (no caso de ser só o municipio, pode pegar na internet as coordenadas).\n\nBRA <- ne_states(country = \"Brazil\", \n                    returnclass = \"sf\")\nMG <- BRA |> filter(name_en == \"Minas Gerais\")\nggplot(BRA) +\ngeom_sf(color = \"black\",\n          fill = \"white\") +\n  geom_point(data = sbr, aes(longitude, latitude), alpha = 0.5)\n\n\n\n\nPara separar a data em dia, mês e ano:\n\nsbr2 <- sbr |>\n  separate(planting, into = \n             c(\"year\", \"month\", \"day\"), sep = \"-\", remove = FALSE)\n\nBRA <- ne_states(country = \"Brazil\", \n                    returnclass = \"sf\")\nMG <- BRA |> filter(name_en == \"Minas Gerais\")\nggplot(BRA) +\ngeom_sf(color = \"black\",\n          fill = \"white\") +\n  geom_point(data = sbr2,\n             aes(longitude, latitude, color = year), alpha = 0.5)+\n  facet_wrap(~year)+\n  theme_void()\n\n\n\n\nComo inserir a rosa dos ventos e a escala no mapa:\n\nlibrary(ggspatial)\n\nWarning: package 'ggspatial' was built under R version 4.2.3\n\nggplot(BRA) +\n  annotation_north_arrow(location = \"bl\")+\n  annotation_scale(location = \"br\")+\n  geom_sf(color = \"black\",\n          fill = \"white\") +\n  geom_point(data = sbr2,\n             aes(longitude, latitude, color = year, size = severity), alpha = 0.5)+\n  labs(color = \"Planting Year\")+\n  theme_minimal()+\n  theme(legend.position = \"right\")\n\nScale on map varies by more than 10%, scale bar may be inaccurate\n\n\n\n\n\nMalha de municipios: Pega o arquivo shape, que baixado dos municipios em um site do IBJE ou outro confiável. Usa o pacote rgdal e executa os eeguintes comandos:\n\nlibrary(ggplot2)\nggplot()+\n   geom_sf(data = MG, fill = \"red\")+\n     labs(title = \"ESTADO DE MINAS GERAIS\")"
  },
  {
    "objectID": "aula17.html",
    "href": "aula17.html",
    "title": "Aula17",
    "section": "",
    "text": "library(gsheet)\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\ndat <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/15pCj0zljvd-TGECe67OMt6sa21xO8BqUgv4d-kU8qi8/edit#gid=0\")\n\noptions(scipen=999)\ndat2 <- dat |> \n  select(-Isolate, -Population) |> \n  group_by(Code, Year, Dose) |> \n  summarise(GC_mean = mean(GC)) \n\n`summarise()` has grouped output by 'Code', 'Year'. You can override using the\n`.groups` argument.\n\nFGT152 <- dat2 |> \n  filter(Code == \"FGT152\")\n\nFGT152 |> \n  ggplot(aes(factor(Dose), GC_mean))+\n  geom_point()+\n  geom_line()\n\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n\n\n\n\ndat2 |> \n   ggplot(aes(factor(Dose), GC_mean))+\n  geom_point()+\n  geom_line()+\n  facet_wrap(~Code)\n\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?"
  },
  {
    "objectID": "aula17.html#ec50-com-pacote-drm",
    "href": "aula17.html#ec50-com-pacote-drm",
    "title": "Aula17",
    "section": "EC50 com pacote DRM",
    "text": "EC50 com pacote DRM\n\nlibrary(drc)\n\nWarning: package 'drc' was built under R version 4.2.3\n\n\nCarregando pacotes exigidos: MASS\n\n\nWarning: package 'MASS' was built under R version 4.2.3\n\n\n\nAttaching package: 'MASS'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\n\n\n'drc' has been loaded.\n\n\nPlease cite R and 'drc' if used for a publication,\n\n\nfor references type 'citation()' and 'citation('drc')'.\n\n\n\nAttaching package: 'drc'\n\n\nThe following objects are masked from 'package:stats':\n\n    gaussian, getInitial\n\ndrc1 <- drm(GC_mean ~ Dose, data = FGT152,\n    fct = LL.3())\nAIC(drc1)\n\n[1] 33.60846\n\nsummary(drc1)\n\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value     p-value    \nb:(Intercept)  0.401905   0.053427  7.5225    0.001672 ** \nd:(Intercept) 47.540342   1.459890 32.5643 0.000005302 ***\ne:(Intercept)  7.220130   2.340119  3.0854    0.036739 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.993805 (4 degrees of freedom)\n\nplot(drc1)\n\n\n\nED(drc1, 50, interval = \"delta\")\n\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50  7.22013    2.34012  0.72292 13.71734\n\n\n\nlibrary(ec50estimator)\n\nWarning: package 'ec50estimator' was built under R version 4.2.3\n\ndf_ec50 <- estimate_EC50(GC_mean ~ Dose,\n                         data = dat2,\n                         isolate_col = \"Code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\n\n\n## Função criada pelo Cha\n\ndf_ED50 <- function(formula, isolate_col, fct = LL.3(), ed_perc = 50, interval = \"delta\", data) {\n  # get the unique values of the isolate column\n  isolates <- unique(data %>% pull(isolate_col))\n\n  # apply drm() and ED() to each isolate\n  quiet_map <- quietly(map_df)\n  results <- quiet_map(\n    isolates, \n    ~{\n      # subset the data for the current isolate\n      isolate_data <- data %>% filter(!!sym(isolate_col) == .x)\n      \n      # apply drm()\n      drm_result <- drm(formula, data = isolate_data, fct = fct)\n      \n      # apply ED() and extract the EC50 value and its confidence interval\n      ed_result <- as.data.frame(ED(drm_result, ed_perc, interval = interval))\n      \n      # return as a data frame\n      tibble(\n        isolate = .x,\n        EC50 = ed_result[\"e:1:50\", \"Estimate\"],\n        lower = ed_result[\"e:1:50\", \"Lower\"],\n        upper = ed_result[\"e:1:50\", \"Upper\"]\n      )\n    }\n  )$result\n\n  return(results)\n}\n\nresults <- df_ED50(GC_mean ~ Dose, \n                   isolate_col = \"Code\", \n                   data = dat2)\n\n\n# print the results\nresults\n\n# A tibble: 12 × 4\n   isolate    EC50    lower  upper\n   <chr>     <dbl>    <dbl>  <dbl>\n 1 FGT152   7.22     0.723  13.7  \n 2 FGT169   0.577    0.0549  1.10 \n 3 FGT170   2.28     1.41    3.15 \n 4 FGT186   3.29    -1.15    7.72 \n 5 FGT187   0.0985  -0.0226  0.220\n 6 FGT189   9.30     2.29   16.3  \n 7 FGT201   4.93     0.172   9.68 \n 8 FGT202  13.8    -17.4    45.0  \n 9 FGT215   0.505    0.213   0.797\n10 FGT229   0.568   -0.241   1.38 \n11 FGT231   1.83     0.153   3.50 \n12 FGT232   0.340    0.105   0.575"
  },
  {
    "objectID": "aula18.html",
    "href": "aula18.html",
    "title": "Aula18",
    "section": "",
    "text": "##Transfomação de dados BOX in COX\nQuando um atributo tem a aparência de uma curva normal mas está deslocado para a direita ou para a esquerda, nos referimos à esta característica como skew. Este deslocamento pode ser ajustado para que o atributo se pareça mais com uma distribuição Normal. Box-Cox nos permite realizar esta transformação, porém assume que todos os valores são positivos.\n\n#Primeiramente vejamos um valor para lambda: aqui estamos usando um pacote de dados cars do R\n\n\nlibrary(MASS)\n\nWarning: package 'MASS' was built under R version 4.2.3\n\nboxcox(dist~speed,data=cars, plotit=T, lam=seq(-1, 1, 1/10))\n\n\n\n\n\n#O gráfico mostra que a função que maximiza a função é aproximadamente 0.5, logo:\n  \nboxcox=((cars^(0.5))-1)/0.5\n\nsummary(boxcox)\n\n     speed            dist        \n Min.   :2.000   Min.   : 0.8284  \n 1st Qu.:4.928   1st Qu.: 8.1980  \n Median :5.746   Median :10.0000  \n Mean   :5.719   Mean   :10.4844  \n 3rd Qu.:6.718   3rd Qu.:12.9666  \n Max.   :8.000   Max.   :19.9089  \n\n\n\nshapiro.test(boxcox[,1])\n\n\n    Shapiro-Wilk normality test\n\ndata:  boxcox[, 1]\nW = 0.95985, p-value = 0.08764"
  },
  {
    "objectID": "aula2.html",
    "href": "aula2.html",
    "title": "Aula2",
    "section": "",
    "text": "O carregamento de pacotes pode ser feito pelo menu ou então com um comando no console. O fluxo básico da programação pode ser conferido neste link.\nAbaixo demonstraremos como instalar e carregar um pacote. A instalação é feita através do menu: Tools > Install packages.\n\nlibrary(tidyverse)\nlibrary(gsheet)\n\nVamos ver como invocar uma função de um pacote\n\nmtcars\n\n                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb\nMazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4\nDatsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1\nHornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1\nHornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2\nValiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1\nDuster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4\nMerc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2\nMerc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2\nMerc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4\nMerc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4\nMerc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3\nMerc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3\nMerc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3\nCadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4\nLincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4\nChrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4\nFiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1\nHonda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2\nToyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1\nToyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1\nDodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2\nAMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2\nCamaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4\nPontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2\nFiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1\nPorsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2\nLotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2\nFord Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4\nFerrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6\nMaserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8\nVolvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2\n\narrange(mtcars, -mpg)\n\n                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb\nToyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1\nFiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1\nHonda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2\nLotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2\nFiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1\nPorsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2\nMerc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2\nDatsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1\nMerc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2\nToyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1\nHornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1\nVolvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2\nMazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4\nMazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4\nFerrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6\nMerc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4\nPontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2\nHornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2\nValiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1\nMerc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4\nMerc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3\nMerc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3\nFord Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4\nDodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2\nMerc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3\nAMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2\nMaserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8\nChrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4\nDuster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4\nCamaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4\nCadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4\nLincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4\n\n\n\nurl <- 'docs.google.com/spreadsheets/d/1I9mJsS5QnXF2TNNntTy-HrcdHmIF9wJ8ONYvEJTXSNo'\nmtcars <- gsheet2tbl(url)\nhead(mtcars)\n\n# A tibble: 6 × 11\n    mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb\n  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n1  21       6   160   110  3.9   2.62  16.5     0     1     4     4\n2  21       6   160   110  3.9   2.88  17.0     0     1     4     4\n3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1\n4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1\n5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2\n6  18.1     6   225   105  2.76  3.46  20.2     1     0     3     1"
  },
  {
    "objectID": "aula3.html",
    "href": "aula3.html",
    "title": "Aula3",
    "section": "",
    "text": "## A função data.frame() cria estruturas cujas colunas podem ser valores numéricos ou caracteres. É uma estrutura muito utilizada em funções do software R.\n\nx22 <- data.frame(\n      expand.grid(Ambiente = c(\"A1\", \"A2\"),\n                  Genotipo = c(\"G1\", \"G2\", \"G3\"),\n                  Rep = c(\"I\", \"II\", \"III\")),\n                  Y = rnorm(18, 50, 15))\nstr(x22)\n\n'data.frame':   18 obs. of  4 variables:\n $ Ambiente: Factor w/ 2 levels \"A1\",\"A2\": 1 2 1 2 1 2 1 2 1 2 ...\n $ Genotipo: Factor w/ 3 levels \"G1\",\"G2\",\"G3\": 1 1 2 2 3 3 1 1 2 2 ...\n $ Rep     : Factor w/ 3 levels \"I\",\"II\",\"III\": 1 1 1 1 1 1 2 2 2 2 ...\n $ Y       : num  30.5 47.7 75 31.2 43.8 ...\n\n# 'data.frame': 18 obs. of  4 variables:\n#  $ Ambiente: Factor w/ 2 levels \"A1\",\"A2\": 1 2 1 2 1 2 1 2 1 2 ...\n#  $ Genotipo: Factor w/ 3 levels \"G1\",\"G2\",\"G3\": 1 1 2 2 3 3 1 1 2 2 ...\n#  $ Rep     : Factor w/ 3 levels \"I\",\"II\",\"III\": 1 1 1 1 1 1 2 2 2 2 ...\n#  $ Y       : num  37.1 75.7 49 43.2 37.5 ...\n\n\nFrom packages\n\ncars2 <- cars\nspeed <- cars2$speed\nspeed\n\n [1]  4  4  7  7  8  9 10 10 10 11 11 12 12 12 12 13 13 13 13 14 14 14 14 15 15\n[26] 15 16 16 17 17 17 18 18 18 18 19 19 19 20 20 20 20 20 22 23 24 24 24 24 25\n\n\n\nlibrary(r4pde)\ndf <- RustSoybean\n\n\n\n\nlibrary(readxl)\nmagnesio <- read_excel(\"C:dados-diversos.xlsx\")\nescala1 <- read_excel(\"C:dados-diversos.xlsx\", \"escala\")\nescala2 <- read_excel(\"C:dados-diversos.xlsx\", 2)"
  },
  {
    "objectID": "aula4.html",
    "href": "aula4.html",
    "title": "Aula4",
    "section": "",
    "text": "library(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(readxl)\n\ncurve<-read_excel(\"C:dados-diversos.xlsx\", \"curve\")\n\n\n\n\n\ncurve |> \n  ggplot(aes(Irrigation, severity,\n             shape = Irrigation))+\n  geom_point(alpha = 0.5)\n\n\n\n\n\ncurve2 <- curve |> \n  select(day, rep, severity) |> \n  group_by(day) |> \n  summarize(sev = mean(severity))\n\n\ncurve2 |> \n  ggplot(aes(day, sev*100))+\n  geom_line(color = \"darkorange\")+\n  geom_point(size = 3,\n             color = \"darkorange\")+\n   scale_x_continuous(breaks = c(0,7, 14, 21, 28, 35, 42, 49, 56, 63))+\n  scale_y_continuous(n.breaks = 5,\n                     limits = c(0,100))+\n    labs(x = \"Time (days)\",\n         y = \"Severity (%)\",\n         title = \"My first disease progress curve\",\n         subtitle = \"Using ggplot\",\n         caption = \"Source: FIP 606\")+\n  theme_light()\n\n\n\nggsave(\"figures/myfirstggplot.png\", \n       bg = \"white\",\n       width = 4,\n       height = 3)"
  },
  {
    "objectID": "aula5.html",
    "href": "aula5.html",
    "title": "Aula5",
    "section": "",
    "text": "library(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(readxl)\nmg <- read_excel(\"C:dados-diversos.xlsx\")\n\n\n\n\n\np_box <- mg |> \n  ggplot(aes(trat, comp))+\n  #geom_point()+\n  geom_boxplot(outlier.color = NA,\n               fill = \"orange\",\n               size = 0.5,\n               width = 0.4)+\n  geom_jitter(width = 0.1, \n              height = 0,\n              size =2,\n              color = \"black\")+\n  scale_y_continuous(limits = c(7,19),\n                     n.breaks = 6)+\n  labs(y = \"Lesion size (mm)\",\n       x = \" \")+\n  theme_bw()\np_box\n\n\n\nggsave(\"figs/plot2.png\",\n         width = 4,\n       height = 4,\n       bg = \"white\")\n\n\nlibrary(ggthemes)\n\nWarning: package 'ggthemes' was built under R version 4.2.3\n\np_means <- mg |> \n  group_by(trat) |> \n  summarise(comp_mean = mean(comp),\n            comp_sd = sd(comp)) |> \n  ggplot(aes(trat, comp_mean))+\n  #geom_col(fill = \"orange\",\n   #        width = 0.5)+\n  geom_point()+\n  scale_y_continuous(limits = c(7,18),\n                     n.breaks = 6)+\n  geom_errorbar(aes(ymin = comp_mean - comp_sd , \n                    ymax = comp_mean + comp_sd,\n                    width = 0.05))+\n  theme_bw()+\n  labs(y = \"Lesion size (mm)\",\n       x = \" \")\np_means\n\n\n\nggsave(\"figs/mean_sd.png\",\n       width = 4,\n       height = 4,\n       bg = \"white\")\n\n\n\n\n\nlibrary(patchwork)\n\nWarning: package 'patchwork' was built under R version 4.2.3\n\n(p_box | p_means) +\n  plot_annotation(tag_levels = 'A',\n                  title = 'Gráficos que impressionam')\n\n\n\nggsave(\"figs/combined.png\")\n\nSaving 7 x 5 in image\n\n\n\nsurvey <- read_excel(\"C:dados-diversos.xlsx\",\n                     sheet = \"survey\")\n\nsurvey |> \n  filter(state == \"RS\") |> \n  count(species, residue) |> \n  ggplot(aes(species, n))+\n  geom_col(width = 0.4, \n           fill = \"steelblue\")+\n   coord_flip()+\n  facet_wrap(~residue, ncol = 1)+\n  labs(x = \"\", y = \"Number of isolates\",\n       title = \"Horizontal bar plot\",\n       subtitle = \"Using ggplot\")+\n  theme_bw()\n\n\n\nggsave(\"figs/barplot.png\", bg = \"white\")\n\nSaving 7 x 5 in image"
  },
  {
    "objectID": "aula6.html",
    "href": "aula6.html",
    "title": "Aula6",
    "section": "",
    "text": "library(readxl)\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nfungicida <- read_excel(\"dados-diversos.xlsx\", \"fungicida_campo\")\nhead(fungicida)\n\n# A tibble: 6 × 4\n  trat         rep   sev   yld\n  <chr>      <dbl> <dbl> <dbl>\n1 testemunha     1  74    406.\n2 testemunha     2  76    436.\n3 testemunha     3  77.5  455.\n4 testemunha     4  75.5  395.\n5 A              1  28.5  755.\n6 A              2  30    758.\n\n\n\nfungicida |> \n  ggplot(aes(trat, yld))+\n  geom_jitter(width = 0.1, \n              color = \"gray60\")+\n  stat_summary(fun.data  = mean_se, \n               color = \"red\")\n\n\n\n\n\nlibrary(ggthemes)\n\nWarning: package 'ggthemes' was built under R version 4.2.3\n\nfungicida |> \n  ggplot(aes(sev, yld))+\n  geom_point(size = 3, \n             color = \"gray50\")+\n  scale_color_colorblind()+\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              color = \"black\",\n              linetype = \"solid\",\n              size = 1)\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nmilho <- read_excel(\"C:dados-diversos.xlsx\",\n                    \"milho\")\n\n\nmilho |> \n  ggplot(aes(method, index,\n             color = method))+\n  geom_jitter(width = 0.1)+\n  facet_grid(~hybrid)\n\n\n\n\n\n\n\n\ny <- milho |> \n  ggplot(aes(x = yield))+\n  geom_histogram(bins = 10,\n                 color = \"black\", fill = \"green\")\n\ni <- milho |> \n  ggplot(aes(x = index))+\n  geom_histogram(bins = 10,\n                 color = \"black\", fill = \"green\")\n\nlibrary(patchwork)\n\nWarning: package 'patchwork' was built under R version 4.2.3\n\n(y + i) +\n  plot_annotation(tag_levels = \"A\")\n\n\n\nggsave(\"figs/histograms.png\", bg = \"white\")\n\nSaving 7 x 5 in image\n\n\n\n\n\n#Os gráficos de densidade, também conhecidos como curvas de densidade suavizadas (smooth density), são esteticamente mais atraentes que os histogramas. Abaixo, vemos um gráfico de densidade para nossos dados de altura:\n\nmilho |> \n  ggplot(aes(x = yield))+\n  geom_density()\n\n\n\n\n\n\n\n#No formato amplo (wide format), as respostas de um mesmo indivíduos estarão em uma única linha e cada resposta estará em uma coluna separada. #No formato longo (long format), cada linha é um ponto de tempo por assunto. Portanto, cada sujeito (condado) terá dados em várias linhas. Todas as variáveis que não mudam ao longo do tempo terão o mesmo valor em todas as linhas.\n\ninsect <- read_excel(\"C:dados-diversos.xlsx\",\n                   \"mortalidade\")\ninsect |> \n  pivot_longer(2:3, \n               names_to = \"status\",\n               values_to = \"value\") |> \n  ggplot(aes(inseticida, value, \n             fill = status))+\n  geom_col()"
  },
  {
    "objectID": "aula7.html",
    "href": "aula7.html",
    "title": "aula7",
    "section": "",
    "text": "#Transformando os dados"
  },
  {
    "objectID": "aula7.html#histogram",
    "href": "aula7.html#histogram",
    "title": "aula7",
    "section": "Histogram",
    "text": "Histogram\n\nh <- mofo |> \n  ggplot(aes(scl))+\n  geom_histogram(bins = 10)\n\n\nb <- mofo |> \n  ggplot(aes(scl))+\n  geom_boxplot()\n\n\nlibrary(patchwork)\n\nWarning: package 'patchwork' was built under R version 4.2.3\n\nh / b\n\n\n\n\n\nmofo2 <- mofo \n\n\nh2 <- mofo2 |> \n  ggplot(aes(yld))+\n  geom_histogram(bins = 10)\nh2\n\n\n\nh / h2\n\n\n\n\n\nsurvey <- read_excel(\"dados-diversos.xlsx\", \"survey\")\n\nsurvey |> \n  filter(state == \"RS\") |> \n  count(species, residue) |> \n  arrange(n) |> \n  rename(res = residue) |> \n  mutate(n_class = case_when(\n          n < 30 ~ \"baixa\",\n          TRUE ~ \"Alta\"))\n\n# A tibble: 4 × 4\n  species res         n n_class\n  <chr>   <chr>   <int> <chr>  \n1 Fspp    corn       22 baixa  \n2 Fspp    soybean    26 baixa  \n3 Fgra    corn      147 Alta   \n4 Fgra    soybean   255 Alta"
  },
  {
    "objectID": "aula8.html",
    "href": "aula8.html",
    "title": "Aula8",
    "section": "",
    "text": "#Teste de hipóteses (Teste T)\n\nlibrary(tidyverse)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\n\nWarning: package 'tibble' was built under R version 4.2.3\n\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n\nlibrary(readxl)\n\nmg<- read_excel(\"C:dados-diversos.xlsx\")\n\n\nmg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width =0.05)+\n  geom_boxplot(fill = NA, \n               outlier.colour = NA)+\n  ylim(5, 20)+\n  annotate(geom = \"text\",\n           x = 0.7, y = 19,\n           label = \"t = 8.12; P < 0.001;\")\n\n\n\n\n\nmg |> \n  \n  ggplot(aes(trat, comp))+\n  stat_summary(fun.data = \"mean_se\")\n\n\n\n\n\nmg2 <- mg |> \n  pivot_wider(1, \n              names_from = trat,\n              values_from = comp)\n\nWarning: Specifying the `id_cols` argument by position was deprecated in tidyr 1.3.0.\nℹ Please explicitly name `id_cols`, like `id_cols = 1`.\n\n\n\nt <- t.test(mg2$Mg2, mg2$control)\nt\n\n\n    Welch Two Sample t-test\n\ndata:  mg2$Mg2 and mg2$control\nt = -8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -6.490393 -3.825607\nsample estimates:\nmean of x mean of y \n   10.520    15.678 \n\nlibrary(report)\n\nWarning: package 'report' was built under R version 4.2.3\n\nreport(t)\n\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between mg2$Mg2 and\nmg2$control (mean of x = 10.52, mean of y = 15.68) suggests that the effect is\nnegative, statistically significant, and large (difference = -5.16, 95% CI\n[-6.49, -3.83], t(17.35) = -8.15, p < .001; Cohen's d = -3.65, 95% CI [-5.12,\n-2.14])"
  },
  {
    "objectID": "aula8.html#using-the-infer-package",
    "href": "aula8.html#using-the-infer-package",
    "title": "Aula8",
    "section": "Using the infer package",
    "text": "Using the infer package\n\nlibrary(infer)\n\nWarning: package 'infer' was built under R version 4.2.3\n\nmg |> \n  t_test(comp ~ trat,\n         order = c(\"control\", \"Mg2\"))\n\n# A tibble: 1 × 7\n  statistic  t_df     p_value alternative estimate lower_ci upper_ci\n      <dbl> <dbl>       <dbl> <chr>          <dbl>    <dbl>    <dbl>\n1      8.15  17.4 0.000000242 two.sided       5.16     3.83     6.49\n\n\nhttps://www.datanovia.com/en/lessons/t-test-in-r/"
  },
  {
    "objectID": "aula9.html",
    "href": "aula9.html",
    "title": "Aula9",
    "section": "",
    "text": "Nesta seção trataremos de formas de análisar dados em experimentos onde as causas da variação na resposta são controladas o máximo possível e o erro experimental minimizado. Veremos os tipos de análise de acordo com o número e tipo de variáveis independentes (níveis do fator) e também o número de tratamentos ou grupos a serem comparados. Iniciaremos primeiramente com os casos mais simples quanto ao número de grupos e iremos avançando conforme aumentamos a complexidade do experimento bem com algumas variações possíveis quanto ao número e tipo de variáveis resposta de interesse."
  },
  {
    "objectID": "aula9.html#preparo-pré-análise",
    "href": "aula9.html#preparo-pré-análise",
    "title": "Aula9",
    "section": "Preparo pré-análise",
    "text": "Preparo pré-análise\n\nlibrary(magrittr) # para usar pipes\nlibrary(ggplot2) # para gráficos\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\nlibrary(dplyr)\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(readxl)\nlibrary(tidyr)\n\n\nAttaching package: 'tidyr'\n\n\nThe following object is masked from 'package:magrittr':\n\n    extract\n\n\nDados no formato excel, então iremos utilizar o pacote readxl\n\ndata_mg <- read_excel(\"C:dados-diversos.xlsx\")\nhead(data_mg)\n\n# A tibble: 6 × 3\n  trat    rep  comp\n  <chr> <dbl> <dbl>\n1 Mg2       1   9  \n2 Mg2       2  12.5\n3 Mg2       3  10  \n4 Mg2       4   8  \n5 Mg2       5  13.2\n6 Mg2       6  11  \n\n\nA maneira mais simples é visualizar, no caso de mais de 6 repetições, usando boxplots juntamente com os dados de cada repetição.\n\ndata_mg %>%\n  ggplot(aes(trat, comp)) +\n  geom_boxplot(outlier.color = NA) +\n  geom_jitter(width = 0.1, shape = 1)\n\n\n\n\nVamos obter estatísticas que descrevem o conjunto, seja a tendência central ou a dispersão dos dados. No caso, será a média, variância, desvio padrão, erro padrão e intervalo de confiança - esse último para inferência visual.\n\ndat2 <- data_mg %>%\n  group_by(trat) %>%\n  summarise(\n    mean_comp = mean(comp),\n    sd_comp = sd(comp),\n    var_comp = var(comp),\n    n = n(),\n    se_comp = sd_comp / sqrt(n - 1),\n    ci = se_comp * qt(0.025, df = 9) # paramétrico\n  )\ndat2\n\n# A tibble: 2 × 7\n  trat    mean_comp sd_comp var_comp     n se_comp     ci\n  <chr>       <dbl>   <dbl>    <dbl> <int>   <dbl>  <dbl>\n1 Mg2          10.5    1.54     2.39    10   0.515 -1.16 \n2 control      15.7    1.27     1.61    10   0.424 -0.958\n\n\nJá podemos visualizar os dados com as estatísticas calculadas. Abaixo, as barras verticais represntam o intervalo de confiança 95%.\n\ndat2 %>%\n  ggplot(aes(trat, mean_comp)) +\n  geom_jitter(\n    data = data_mg, aes(trat, comp),\n    color = \"grey\",\n    width = 0.05\n  ) +\n  geom_errorbar(aes(\n    ymin = mean_comp - ci,\n    ymax = mean_comp + ci\n  ),\n  width = 0.05\n  ) +\n  geom_point(size = 3)\n\n\n\n\nO conjunto está no formato largo, assim a variável resposta de interesse está apenas em uma coluna. Existem várias formas de separar em dois vetores os dados de resposta para cada tratamento. Uma delas é por meio da função spread do pacote tidyr, a qual coloca as respostas em duas colunas, uma para cada tratamento. Vamos criar o conjunto data_mg2.\n\ndata_mg2 <- data_mg %>%\n  spread(trat, comp)\ndata_mg2\n\n# A tibble: 10 × 3\n     rep control   Mg2\n   <dbl>   <dbl> <dbl>\n 1     1    13.7   9  \n 2     2    15.9  12.5\n 3     3    15.7  10  \n 4     4    14.2   8  \n 5     5    15.9  13.2\n 6     6    16.5  11  \n 7     7    18    10.8\n 8     8    14.4   9.5\n 9     9    16.4  10.8\n10    10    16    10.4"
  },
  {
    "objectID": "aula9.html#análise-inferencial",
    "href": "aula9.html#análise-inferencial",
    "title": "Aula9",
    "section": "Análise inferencial",
    "text": "Análise inferencial\nUsando o conjunto original, vamos visualizar as respostas (tamanho da lesão) para cada tratamento, já que O ggplot2 requer os dados no formato largo.\n\n# usando pipes\ndata_mg %>%\n  ggplot(aes(trat, comp)) +\n  geom_jitter(width = 0.1, height = 0) +\n  ylim(5, 20) # ajusta o eixo y para melhor visualização\n\n\n\n\n\nHomocedasticidade\nNo caso de dois grupos, a função que pode ser usada é a var.test do R. Vamos usar o formato largo e chamar os dois vetores do conjunto. Verifique o P-valor na saída da análise.\n\nattach(data_mg2) # vamos facilitar o uso dos vetores\nvar.test(Mg2, control)\n\n\n    F test to compare two variances\n\ndata:  Mg2 and control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n\n\n\n\nNormalidade\nA normalidade pode ser testada por meio de procedimentos visuais e testes específicos.\n\nshapiro.test(Mg2)\n\n\n    Shapiro-Wilk normality test\n\ndata:  Mg2\nW = 0.97269, p-value = 0.9146\n\nshapiro.test(control)\n\n\n    Shapiro-Wilk normality test\n\ndata:  control\nW = 0.93886, p-value = 0.5404\n\n\nAnálise visual da premissa de normalidade.\n\nqqnorm(Mg2)\nqqline(Mg2)\n\n\n\nqqnorm(control)\nqqline(control)\n\n\n\n\n\nmagnesio3 <- data_mg %>%\n  group_by(trat) %>%\n  summarize(\n    mu = mean(comp),\n    sd = sd(comp),\n    n = length(comp),\n    se = sd / sqrt(n),\n    ciu = mu + (qt(0.025, df = n - 1) * se),\n    cil = mu - (qt(0.025, df = n - 1) * se)\n  )\n\n\n\nIntervalo de confiança\n\nmagnesio3 %>%\n  ggplot(aes(trat, mu, color = trat)) +\n  geom_point(size = 3) +\n  ylim(7,20)+\n  geom_errorbar(aes(min = cil, max = ciu), width = 0.05, size = 1) +\n  labs(x = \"Tratamento\", y = \"Valor\", title = \"Magnesium effect on lesion expansion\")\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\nTeste de hipótese\n\nt.test(Mg2, control, paired = F)\n\n\n    Welch Two Sample t-test\n\ndata:  Mg2 and control\nt = -8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -6.490393 -3.825607\nsample estimates:\nmean of x mean of y \n   10.520    15.678 \n\n\n\n\nAlternativas\nSe as premissas de normalidade não fossem atendidas, qual o teste que poderia ser usado? Nesse caso de dois grupos há duas possibilidades, uma é usar um teste não paramétrico ou um teste baseado em reamostragem (bootstrapping) dos dados, os quais independem do modelo de distribuição.\nUsando os mesmos dados podemos notar que o resultado é idêntico porém com P-valores diferentes."
  },
  {
    "objectID": "aula9.html#preparo-pré-análise-1",
    "href": "aula9.html#preparo-pré-análise-1",
    "title": "Aula9",
    "section": "Preparo pré-análise",
    "text": "Preparo pré-análise\n\nescala <- read_excel(\"dados-diversos.xlsx\", \"escala\")\nhead(escala)\n\n# A tibble: 6 × 7\n  assessment rater acuracia precisao vies_geral vies_sistematico vies_constante\n  <chr>      <chr>    <dbl>    <dbl>      <dbl>            <dbl>          <dbl>\n1 Unaided    A        0.809    0.826      0.979            1.19         0.112  \n2 Unaided    B        0.722    0.728      0.991            0.922       -0.106  \n3 Unaided    C        0.560    0.715      0.783            1.16         0.730  \n4 Unaided    D        0.818    0.819      0.999            0.948       -0.00569\n5 Unaided    E        0.748    0.753      0.993            1.10         0.0719 \n6 Unaided    F        0.695    0.751      0.925            0.802        0.336  \n\n\n\nescala %>%\n  gather(component, statistics, 3:7) %>% # formato longo\n  ggplot(aes(reorder(assessment, statistics), statistics)) +\n  geom_jitter(width = 0.05) +\n  facet_wrap(~component, scales = \"free_y\")\n\n\n\n\nPrepara os dados para análise. Cria os vetores de cada grupo para cada variável. Vamos fazer abaixo para acurácia.\n\n# arruma os dados\nescala2 <- select(escala, assessment, rater, acuracia)\nescala3 <- spread(escala2, assessment, acuracia)\n\n\nPremissas\n\n## homocedasticidade dois grupos\nattach(escala3)\nvar.test(Aided1, Unaided)\n\n\n    F test to compare two variances\n\ndata:  Aided1 and Unaided\nF = 0.17041, num df = 9, denom df = 9, p-value = 0.01461\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.04232677 0.68605885\nsample estimates:\nratio of variances \n         0.1704073 \n\n## normalidade\nshapiro.test(Aided1)$p.value\n\n[1] 0.4260888\n\nshapiro.test(Unaided)$p.value\n\n[1] 0.1131276\n\nqqnorm(Aided1)\nqqline(Aided1)\n\n\n\nqqnorm(Unaided)\nqqline(Unaided)\n\n\n\n\n\n\nAnálise inferencial\n\nescala4 <- summarize(group_by(escala2, assessment),\n  mu = mean(acuracia),\n  sd = sd(acuracia),\n  n = length(acuracia),\n  se = sd / sqrt(n),\n  ciu = mu + (qt(0.025, df = n - 1) * se),\n  cil = mu - (qt(0.025, df = n - 1) * se)\n)\n\nVisualiza média e intervalo de confiança\n\nggplot(escala4, aes(assessment, mu)) +\n  geom_point(stat = \"identity\", size = 4) +\n  geom_errorbar(aes(min = cil, max = ciu),\n    width = .05\n  )\n\n\n\n\nVisualiza cada avaliador\n\nggplot(escala2, aes(reorder(assessment, acuracia), acuracia, group = rater)) + geom_point(stat = \"identity\", size = 3, shape = 1) +\n  geom_line(size = 1, color = \"gray70\") + facet_wrap(~rater, nrow = 5)\n\n\n\n\n\n\nTeste t paramétrico\nNote que as amostras são pareadas - mesmo avaliador em dois tempos, portanto há dependência.\n\n## teste t para amostras pareadas\nt_escala <- t.test(escala3$Aided1, escala3$Unaided,\n  paired = TRUE,\n  var.equal = F\n)\n\nt_escala\n\n\n    Paired t-test\n\ndata:  escala3$Aided1 and escala3$Unaided\nt = 5.9364, df = 9, p-value = 0.000219\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.1144707 0.2554241\nsample estimates:\nmean difference \n      0.1849474 \n\n\n\n\nTeste não paramétrico\nPesquise sobre o teste de Wilcoxon.\n\nwilcox.test(escala3$Aided1, escala3$Unaided, paired = TRUE)\n\n\n    Wilcoxon signed rank exact test\n\ndata:  escala3$Aided1 and escala3$Unaided\nV = 55, p-value = 0.001953\nalternative hypothesis: true location shift is not equal to 0"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Aulas Básicas em R",
    "section": "",
    "text": "Bem-vindo ao meu website dedicado ao RStudio.\nAulas sobre análises de dados Fitopatologicos em R, minístradas pelo o professor emdelponte.\nArlam Fernandes\nAgrônomo | Pesquisadora de Mestrado em Fitopatologia | Laboratório de Nematologia Vegetal| Universidade Federal de Viçosa/UFV. Atualmente, meu trabalho de mestrado concentra-se no estudo da resistência genética do cafeeiro aos nematoides das galhas (Meloidogyne Spp), uma das principais doenças que afetam essa cultura."
  }
]